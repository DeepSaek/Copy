name: Copy

on:
  workflow_dispatch:
  schedule:
    - cron: "*/10 * * * *"

jobs:
  Copy1:
    runs-on: ubuntu-latest
    steps:
      - name: ËøÅÂá∫‰ª£Á†Å
        uses: actions/checkout@v3

      - name: ‰∏ãËΩΩ‰ª£Á†Å
        run: |
          # ËÆæÁΩÆ UTC+8 Êó∂Âå∫Âπ∂ÁîüÊàêÊó∂Èó¥
          TS=$(date +%s)
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y%m%d%H%M%S") > time.txt
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y-%m-%d %H:%M:%S") > new_time.txt
          wget https://github.com/ActionsEDU3/Tools/archive/refs/heads/master.zip -O Tools-$(cat time.txt).zip

      - name: ÂèëÈÄÅ‰ª£Á†Å
        run: |
          curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendDocument" \
               -F chat_id="${{ secrets.TELEGRAM_TO }}" \
               -F document=@"Tools-$(cat time.txt).zip" \
               -F caption="‚ù§Ô∏è ‰ª£Á†ÅÂ§á‰ªΩ $(cat new_time.txt)" \
               -F parse_mode="HTML"

      - name: ‰∏ä‰º†‰ª£Á†Å
        uses: actions/upload-artifact@v4
        with:
          name: Code Backup
          path: Tools*.zip

  Copy2:
    runs-on: ubuntu-latest
    steps:
      - name: ËøÅÂá∫‰ª£Á†Å
        uses: actions/checkout@v3

      - name: ‰∏ãËΩΩ‰ª£Á†Å
        run: |
          # ËÆæÁΩÆ UTC+8 Êó∂Âå∫Âπ∂ÁîüÊàêÊó∂Èó¥
          TS=$(date +%s)
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y%m%d%H%M%S") > time.txt
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y-%m-%d %H:%M:%S") > new_time.txt
          wget https://github.com/DeepSaek/OpenWRT/archive/refs/heads/main.zip -O OpenWRT-$(cat time.txt).zip

      - name: ÂèëÈÄÅ‰ª£Á†Å
        run: |
          curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendDocument" \
               -F chat_id="${{ secrets.TELEGRAM_TO }}" \
               -F document=@"OpenWRT-$(cat time.txt).zip" \
               -F caption="üíö ‰ª£Á†ÅÂ§á‰ªΩ $(cat new_time.txt)" \
               -F parse_mode="HTML"

      - name: ‰∏ä‰º†‰ª£Á†Å
        uses: actions/upload-artifact@v4
        with:
          name: Code Backup
          path: OpenWRT*.zip


  Copy3:
    runs-on: ubuntu-latest
    steps:
      - name: ËøÅÂá∫‰ª£Á†Å
        uses: actions/checkout@v3

      - name: ‰∏ãËΩΩ‰ª£Á†Å
        run: |
          # ËÆæÁΩÆ UTC+8 Êó∂Âå∫Âπ∂ÁîüÊàêÊó∂Èó¥
          TS=$(date +%s)
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y%m%d%H%M%S") > time.txt
          echo $(TZ="Asia/Shanghai" date -d "@$TS" "+%Y-%m-%d %H:%M:%S") > new_time.txt
          wget https://github.com/DeepSaek/Copy/archive/refs/heads/main.zip -O Copy-$(cat time.txt).zip

      - name: ÂèëÈÄÅ‰ª£Á†Å
        run: |
          curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendDocument" \
               -F chat_id="${{ secrets.TELEGRAM_TO }}" \
               -F document=@"Copy-$(cat time.txt).zip" \
               -F caption="üíô ‰ª£Á†ÅÂ§á‰ªΩ $(cat new_time.txt)" \
               -F parse_mode="HTML"

      - name: ‰∏ä‰º†‰ª£Á†Å
        uses: actions/upload-artifact@v4
        with:
          name: Code Backup
          path: Copy*.zip
